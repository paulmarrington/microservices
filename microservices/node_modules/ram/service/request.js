var http = require("http");
var url_parser = require("url").parse;

// TODO: If in browser, how do we do this?
const service_register = process.env.RAM_MICROSERVICE_REGISTER_PORT_80_TCP_ADDR;
module.exports = {
  request: (service_name, packet) => {
    return new Promise((resolve, reject) => {
      var request = http.request({
        host:   service_register,
        method: "POST",
        path:   "/"+service_name
      }, (response) => {
        var body = [];
        response.on('data', (chunk) => {
          body.push(chunk)
        });
        response.on('end', (chunk) => {
          resolve(JSON.parse(body.join("\n")))
        })
      });
      request.on("error", (error) => {
        reject(error)
      });
      request.end(JSON.stringify(packet))
    });
  }
};